<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†Ø´Ø¦ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø°ÙƒÙŠ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script>
// ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³Ø§Ø± workerSrc Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ PDF.js
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.16/mammoth.browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
/* Ø£Ù†Ù…Ø§Ø· CSS Ø£Ø³Ø§Ø³ÙŠØ© */
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f4f7f6; color: #333; direction: rtl; }
.container { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); }
h1, h2 { text-align: center; color: #007bff; }
.controls, .form-section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: #f9f9f9; }
label { display: block; margin-bottom: 8px; font-weight: bold; color: #555; }
input[type="text"], input[type="number"], textarea, select { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1em; }
textarea { resize: vertical; }
button { padding: 10px 20px; margin: 5px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: background-color 0.3s, transform 0.2s; }
button:hover { transform: translateY(-1px); }
.primary-btn { background-color: #007bff; color: white; }
.primary-btn:hover { background-color: #0056b3; }
.secondary-btn { background-color: #6c757d; color: white; }
.secondary-btn:hover { background-color: #5a6268; }
.tab-buttons { display: flex; margin-bottom: 20px; border-bottom: 2px solid #ddd; }
.tab { padding: 10px 15px; cursor: pointer; background-color: #f1f1f1; border: 1px solid #ddd; border-bottom: none; border-radius: 8px 8px 0 0; transition: background-color 0.3s; }
.tab.active { background-color: #fff; border-color: #007bff; color: #007bff; font-weight: bold; border-bottom: 2px solid #fff; margin-bottom: -2px; }
.tab-content { display: none; padding: 20px 0; border-top: 1px solid #ddd; }
.tab-content.active { display: block; }
.question-container { border: 1px solid #007bff66; padding: 20px; margin-bottom: 20px; border-radius: 10px; background-color: #ffffff; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); transition: box-shadow 0.3s; }
.question-container:hover { box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); }
.question-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
.question-number { font-weight: bold; color: #007bff; font-size: 1.2em; }
.delete-btn { background-color: #dc3545; color: white; padding: 8px 12px; font-size: 0.9em; margin: 0; }
.delete-btn:hover { background-color: #c82333; }
.options-list { display: flex; flex-direction: column; gap: 10px; margin-top: 10px; }
.option-input { display: flex; align-items: center; gap: 10px; background: #f1f1f1; padding: 8px; border-radius: 6px; border: 1px solid #eee; transition: background 0.3s; }
.option-input:hover { background: #e9ecef; }
.option-input input[type="radio"] { margin-left: 10px; width: auto; flex-shrink: 0; }
.option-input input[type="text"] { margin: 0; flex-grow: 1; }
.option-delete-btn { background-color: #ffc107; color: #333; padding: 5px 10px; font-size: 0.8em; margin: 0; flex-shrink: 0; }
.option-delete-btn:hover { background-color: #e0a800; }
.hidden { display: none !important; }
#timer { font-size: 1.5em; font-weight: bold; color: #28a745; text-align: center; padding: 10px; border: 2px solid #28a745; border-radius: 8px; margin-bottom: 20px; }
#timer.warning { color: #ffc107; border-color: #ffc107; animation: pulse 1s infinite; }
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
/* ğŸ† Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…ÙŠØ²Ø© ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØºÙŠØ± Ø§Ù„Ù…Ø­Ù„ÙˆÙ„Ø© ğŸ† */
.unanswered-question { border: 3px solid #ffc107 !important; background-color: #fff9e6 !important; animation: bounce 0.5s 3; }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-3px); } 100% { transform: translateY(0); } }
/* ğŸ† Ø£Ù†Ù…Ø§Ø· Ø´Ø§Ø´Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© - ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ØµÙˆØ± ğŸ† */
#resultsSection { background-color: #fff; padding: 0; box-shadow: none; }
#resultsSection h2 { color: #007bff; text-align: center; margin-top: 0; margin-bottom: 10px; font-size: 1.8em; }
#resultsSection h2 + p { color: #007bff; font-size: 1.5em; font-weight: bold; margin-bottom: 20px; }
.score-summary-container { display: flex; justify-content: flex-start; align-items: stretch; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
.score-card { background-color: #fff; border: 1px solid #ddd; border-radius: 12px; padding: 20px; text-align: center; flex-basis: 30%; min-width: 150px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; justify-content: center; }
.score-card-primary { border-color: #007bff44; }
.score-value { font-size: 2.5em; font-weight: bold; color: #007bff; line-height: 1.2; }
.score-label { font-size: 0.9em; color: #555; margin-top: 5px; }
.feedback-card { background-color: #fff; border: 1px solid #ddd; border-radius: 12px; padding: 20px; flex-basis: 30%; min-width: 150px; text-align: center; font-weight: normal; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); order: -1; border-right: 8px solid #ffc107; }
.feedback-card .icon { font-size: 2.0em; margin-bottom: 10px; }
.feedback-card .message { font-size: 1em; line-height: 1.5; color: #333; font-weight: bold; }
.feedback-card .message + p { font-size: 0.8em; color: #777; margin-top: 5px; }
.performance-chart-section { padding: 20px; margin-bottom: 30px; border-radius: 12px; background-color: #f9f9f9; border: 1px solid #ddd; }
.performance-chart-section h3 { text-align: right; color: #dc3545; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; }
.chart-bar-container { display: flex; align-items: center; margin-bottom: 10px; font-size: 0.9em; }
.chart-label { width: 80px; text-align: right; margin-left: 10px; flex-shrink: 0; }
.chart-bar-wrap { flex-grow: 1; height: 15px; background-color: #eee; border-radius: 4px; display: flex; overflow: hidden; position: relative; }
.chart-bar { height: 100%; transition: width 1s ease-out; }
.chart-value { position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: #333; font-weight: bold; font-size: 0.8em; }
.performance-summary-table { border: 1px solid #ddd; border-radius: 12px; overflow: hidden; margin-bottom: 30px; background-color: #fff; page-break-inside: avoid; }
.performance-summary-table h3 { background-color: #eaf6ff; color: #007bff; text-align: right; padding: 15px; margin: 0; font-size: 1.2em; }
.performance-table { width: 100%; border-collapse: collapse; text-align: center; }
.performance-table th, .performance-table td { border: 1px solid #eee; padding: 12px 5px; white-space: nowrap; }
.performance-table th { background-color: #f1f1f1; color: #333; font-weight: bold; }
.performance-table .col-total { background-color: #e8f5e9; color: #388e3c; }
.performance-table .col-correct { background-color: #e3f2fd; color: #1976d2; }
.performance-table .col-incorrect { background-color: #ffebee; color: #d32f2f; }
.performance-table .col-unanswered { background-color: #fff3e0; color: #f57f17; }
.performance-table td { font-weight: bold; }
#detailedResults h3 { color: #007bff; text-align: right; margin-top: 30px; border-bottom: 2px solid #007bff; padding-bottom: 10px; font-size: 1.4em; }
.result-item { border: 1px solid #ccc; padding: 15px; margin-bottom: 15px; border-radius: 8px; background-color: #fff; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); }
.result-item.correct { border-right: 5px solid #28a745; background-color: #e6ffed; }
.result-item.incorrect { border-right: 5px solid #dc3545; background-color: #ffe6e6; }
.result-item.unanswered { border-right: 5px solid #ffc107; background-color: #fff9e6; }
.result-item p strong { font-weight: bold; color: #555; }
.status-message { padding: 8px 12px; border-radius: 6px; display: inline-block; font-weight: bold; margin-top: 5px; margin-bottom: 10px; }
.status-message.correct { background-color: #d4edda; color: #155724; }
.status-message.incorrect { background-color: #f8d7da; color: #721c24; }
.status-message.unanswered { background-color: #fff3cd; color: #856404; }
#resultsSection button { padding: 12px 25px; font-size: 1.1em; border-radius: 8px; }
#resultsSection .secondary-btn { background-color: #6c757d; color: white; }
.pdf-page-break { page-break-after: always; }
@media print {
body { background-color: white; padding: 0; margin: 0; }
/* Ø¥Ø®ÙØ§Ø¡ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„ØªØ­ÙƒÙ… */
.container, .controls, button, .tab-buttons, #examSection, #createExamSection, #a4TestBuilder .controls, .header-controls-container, #schoolAnalysisControls, #remedialPlanContainer { display: none !important; }
/* Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© ÙÙ‚Ø· */
#a4TestBuilder:not(.hidden), #resultsSection:not(.hidden), #schoolAnalysisSection:not(.hidden), .print-only, .pdf-content-remedial-print { display: block !important; }
#resultsSection, .print-only { padding: 0; box-shadow: none; }
.result-item { page-break-inside: avoid; }
#schoolAnalysisSection { border: none !important; box-shadow: none !important; background-color: white !important; padding: 0 !important; overflow: visible !important; }
.pdf-page-break { page-break-after: always !important; }
.performance-summary-table, #schoolAnalysisSection h4 { page-break-inside: avoid; }
#a4TestBuilder { max-width: 210mm; margin: 0 auto; padding: 15mm; position: relative !important; z-index: 9999 !important; background-color: white !important; }
.a4-question-container { border: 1px solid #333 !important; box-shadow: none !important; margin-bottom: 10px; padding: 10px; }
#klisheh-section { border: 1px solid #333 !important; padding: 10px; }
textarea { border: none; overflow: hidden; resize: none; }
/* Ensure the Remedial Report is visible and preserves colors (FIX) */
.pdf-content-remedial-print { display: block !important; max-width: 210mm !important; padding: 0 !important; box-shadow: none !important; }
/* FIX: Force colors for PDF/Print */
.report-header-banner, .report-title-box, .section-header { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; color: white !important; }
.report-header-banner { background-color: #004d40 !important; height: 120px !important; /* FIX: Fixed height for logo positioning */ }
.report-title-box { background-color: #003631 !important; }
.section-header.weakness { background-color: #4CAF50 !important; }
.section-header.methods { background-color: #007bff !important; }
.section-header.actions { background-color: #1a73e8 !important; }
.section-header.results { background-color: #555 !important; }
.remedial-report-container { border: none !important; background-color: white !important; }
/* FIX: Ensure logo placement is correct for print */
.report-logo-placeholder { position: absolute !important; right: 20px !important; top: 20px !important; width: 150px !important; height: 75px !important; display: flex !important; justify-content: center !important; align-items: center !important; background-color: transparent !important; }
/* Ensure text in the main body is dark */
.remedial-report-container, .remedial-report-container p, .remedial-report-container strong { color: #333 !important; }
}
.header-controls-container { position: relative; width: 100%; height: 0; display: flex; justify-content: flex-end; }
.dropdown { position: absolute; top: -5px; left: 20px; display: inline-block; z-index: 1000; }
.dropbtn { background-color: transparent; color: #333; padding: 5px; font-size: 24px; border: none; cursor: pointer; }
.dropdown-content { display: none; position: absolute; background-color: #f9f9f9; min-width: 250px; box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); z-index: 100; left: 0; border-radius: 8px; text-align: right; }
.dropdown-content a { color: #333; padding: 12px 16px; text-decoration: none; display: block; transition: background-color 0.3s; }
.dropdown-content a:hover { background-color: #007bff; color: white; }
.dropdown:hover .dropdown-content { display: block; }
.a4-question-container { border: 1px solid #007bff66; padding: 20px; margin-bottom: 20px; border-radius: 10px; background-color: #ffffff; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); }
#schoolAnalysisSection { margin-top: 40px; padding: 25px; border: 2px solid #28a745; border-radius: 12px; background-color: #e6ffe6; text-align: right; overflow: visible; }
#schoolAnalysisSection h3 { color: #28a745; border-bottom: 2px solid #28a745; padding-bottom: 10px; margin-top: 0; text-align: center; }
#schoolSummary { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; }
.analysis-card { background-color: #fff; padding: 15px; border-radius: 8px; flex: 1 1 200px; text-align: center; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
.analysis-card-value { font-size: 2em; font-weight: bold; color: #007bff; }
.school-chart-container { padding: 20px; margin-bottom: 25px; border-radius: 8px; background-color: #fff; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); }
.chart-heading { text-align: center; color: #007bff; margin-bottom: 15px; font-size: 1.5em; border-bottom: 2px solid #eee; padding-bottom: 10px; }
.chart-bar-wrap-full { display: flex; height: 35px; border-radius: 8px; overflow: hidden; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) inset; position: relative; }
.chart-bar-full { height: 100%; transition: width 1s ease-out; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.9em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3); min-width: 10%; position: relative; padding: 0 5px; }
.chart-legend { display: flex; justify-content: center; gap: 20px; font-size: 0.9em; font-weight: bold; }
.legend-item { display: flex; align-items: center; }
.legend-color { width: 12px; height: 12px; border-radius: 3px; margin-left: 5px; }
/* ğŸ†• Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ğŸ†• */
#remedialPlanContainer { margin-top: 40px; padding: 25px; border: 2px solid #007bff; border-radius: 12px; background-color: #f0f8ff; text-align: right; overflow: visible; }
#remedialPlanContainer h3 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 10px; margin-top: 0; text-align: center; }
.remedial-list { display: flex; flex-direction: column; gap: 8px; padding: 10px; border: 1px dashed #ccc; border-radius: 6px; margin-bottom: 15px; background-color: #ffffff; }
.remedial-list label { font-weight: normal; display: flex; align-items: center; gap: 10px; margin-bottom: 0; cursor: pointer; }
.remedial-list input[type="checkbox"] { width: auto; margin: 0; }
/* ------------------------------------------------------------------- */
/* ğŸ†• Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ØµÙˆØ±Ø©) ğŸ†• */
/* ------------------------------------------------------------------- */
.remedial-report-container { max-width: 210mm; /* A4 width */ margin: 0 auto; padding: 0; direction: rtl; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 11pt; color: #333; background-color: #fff; /* Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ø±Ø¶ */ border: none; box-shadow: none; }
.report-header-banner { background-color: #004d40; /* Deep Teal/Green for the top banner */
color: white; padding: 30px 20px 0 20px; /* Reduced bottom padding */
margin-bottom: 20px; border-radius: 0 0 12px 12px; text-align: center; position: relative; overflow: hidden; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); background: linear-gradient(to right, #004d40, #14a081); height: 120px; /* FIX: Fixed height for better control */
display: flex; flex-direction: column; justify-content: flex-end; }
.report-header-content { /* Removed justify-content: center; */
justify-content: flex-end; /* Align to the right in RTL */
align-items: center; gap: 30px; width: 100%; position: absolute; /* Take it out of the normal flow */
top: 0; right: 0; padding: 10px 20px; }
.report-logo-placeholder { width: 150px; height: 75px; display: flex; /* FIX: Use flex */
justify-content: center; align-items: center; font-size: 0.9em; font-weight: bold; color: #c8e6c9; background-color: transparent; /* FIX: Changed to transparent */
border-radius: 8px; padding: 5px; position: absolute; /* FIX: Position the logo */
right: 20px; /* FIX: Position it on the right */
top: 20px; }
.report-logo-placeholder img { max-width: 100%; max-height: 100%; object-fit: contain; }
.report-title-box { background-color: #003631; /* Even darker teal/blue */
color: white; padding: 10px 25px; border-radius: 8px; margin: -30px auto 20px auto; /* Lifts the box into the banner area */
width: 60%; /* FIX: Increased width */
max-width: 400px; text-align: center; font-size: 1.3em; font-weight: bold; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); border: 1px solid #14a081; }
.report-info-section { text-align: center; margin-bottom: 25px; line-height: 1.8; }
.report-info-section p { margin: 5px 0; font-size: 1.1em; font-weight: 500; }
.report-info-section strong { color: #007bff; font-weight: bold; }
.report-section { border: 1px solid #eee; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); overflow: hidden; page-break-inside: avoid; }
.section-header { padding: 12px 20px; color: white; font-size: 1.2em; font-weight: bold; display: flex; justify-content: flex-end; align-items: center; }
.section-header i { margin-left: 10px; }
.section-header.student { background-color: #004d40; } /* Dark Teal/Green for Student */
.section-header.weakness { background-color: #4CAF50; } /* Green */
.section-header.methods { background-color: #007bff; } /* Blue */
.section-header.actions { background-color: #1a73e8; } /* Darker Blue */
.section-header.results { background-color: #555; } /* Dark Gray */
.section-body { padding: 20px; background-color: white; font-size: 10.5pt; }
.section-body ul { list-style-type: none; padding: 0; margin: 0; }
.section-body ul li { margin-bottom: 8px; padding-right: 20px; position: relative; line-height: 1.6; }
.section-body ul li::before { content: 'â€¢'; color: #4CAF50; /* Green bullet for points */
font-size: 1.2em; position: absolute; right: 0; top: 0; }
.section-header.methods + .section-body ul li::before { color: #007bff; }
.section-header.actions + .section-body ul li::before { color: #1a73e8; }
.report-signature-section { display: flex; justify-content: space-around; text-align: center; margin-top: 50px; padding-bottom: 20px; page-break-inside: avoid; }
.report-signature-section div { width: 45%; font-weight: bold; padding-top: 10px; border-top: 1px dashed #777; color: #555; font-size: 1.1em; }
/* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© */
.pdf-content-remedial-print { display: none; /* Hide the temp container */
}
</style>
</head>
<body>
<div class="container">
<div class="header-controls-container">
<div class="dropdown">
<button class="dropbtn">...</button>
<div id="mainDropdown" class="dropdown-content">
<a href="#" onclick="showA4TestBuilder()">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠ Ø£Ùˆ Ø´Ù‡Ø±ÙŠ</a>
<a href="#" onclick="showSchoolAnalysis()">ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©/Ø§Ù„ÙØµÙˆÙ„</a>
<a href="#" onclick="showRemedialPlan()">ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©</a>
</div>
</div>
</div>
<div id="originalContent">
<h1>ğŸ› ï¸ Ù…Ù†Ø´Ø¦ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h1>
<div id="createExamSection">
<h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
<div class="controls">
<label for="examName">Ø§Ø³Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</label>
<input type="text" id="examName" value="Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±">
<label for="examDuration">Ù…Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚:</label>
<input type="number" id="examDuration" value="30" min="1">
</div>
<h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ… ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„</h2>
<div class="controls">
<label for="submissionDays">Ù…Ø¯Ø© ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ³Ù„ÙŠÙ… (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…):</label>
<input type="number" id="submissionDays" value="7" min="1">
<p id="deadlineInfo" style="font-size: 0.9em; color: #007bff;"></p>
<hr>
<label>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ù† Ù…Ù„Ù (TXT, PDF, DOCX):</label>
<div class="file-upload-area" onclick="document.getElementById('fileUpload').click()">
<p>Ø§Ù†Ù‚Ø± Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ù…Ù„ÙÙ‹Ø§ Ù‡Ù†Ø§ (.txt, .pdf, .docx)</p>
<p style="font-size: 0.9em; color: #dc3545;">ğŸš¨ **Ù…Ù„Ø§Ø­Ø¸Ø©:** Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ **Ø¨Ø¯Ø§ÙŠØ©** Ø£Ùˆ **Ù†Ù‡Ø§ÙŠØ©** Ø§Ù„Ø³Ø¤Ø§Ù„ Ø£Ùˆ Ø§Ù„Ø®ÙŠØ§Ø±: `<<<ØµØ­ÙŠØ­>>>` Ø£Ùˆ `*` Ø£Ùˆ `**` Ø£Ùˆ `ØµØ­` Ø£Ùˆ `Ø®Ø·Ø£` Ø£Ùˆ `âœ…` Ø£Ùˆ `âŒ`.</p>
<input type="file" id="fileUpload" accept=".txt,.pdf,.docx" onchange="handleFileUpload()" style="display: none;">
</div>
<hr>
<button class="secondary-btn" onclick="saveExam()">ğŸ’¾ Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
<input type="file" id="loadExamFile" accept=".json" style="display: none;" onchange="loadSavedExam()">
<button class="secondary-btn" onclick="document.getElementById('loadExamFile').click()">ğŸ“‚ ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ£Ø³Ø¦Ù„Ø© Ø³Ø§Ø¨Ù‚Ø©</button>
</div>
<h2>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØªØ¹Ø¯ÙŠÙ„Ù‡Ø§</h2>
<div class="controls">
<div class="tab-buttons">
<button class="tab active" data-tab-name="trueFalse" onclick="switchTab('trueFalse')">ØµÙˆØ§Ø¨/Ø®Ø·Ø£</button>
<button class="tab" data-tab-name="multipleChoice" onclick="switchTab('multipleChoice')">Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯</button>
</div>
<div id="trueFalseTab" class="tab-content active">
<button class="primary-btn" onclick="addTFQuestion()">â• Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ ØµÙˆØ§Ø¨/Ø®Ø·Ø£ Ø¬Ø¯ÙŠØ¯</button>
<div id="tfQuestions" style="margin-top: 20px;">
</div>
</div>
<div id="multipleChoiceTab" class="tab-content">
<button class="primary-btn" onclick="addMCQuestion()">â• Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ Ø¬Ø¯ÙŠØ¯</button>
<div id="mcQuestions" style="margin-top: 20px;">
</div>
</div>
</div>
<h2>ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
<div class="controls">
<label for="studentName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨ / Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
<input type="text" id="studentName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨/Ø© Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ" required style="margin-bottom: 20px;">
<label>ØªØ­Ø¯ÙŠØ¯ Ù…Ø¯Ù‰ ÙˆØ£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§:</label>
<div style="display: flex; gap: 20px; margin-bottom: 10px;">
<div style="flex: 1;">
<label for="rangeStart">Ø¨Ø¯Ø§ÙŠØ© Ù…Ø¯Ù‰ Ø§Ù„ØªØ±Ù‚ÙŠÙ… (Ù…Ø«Ù„ 20):</label>
<input type="number" id="rangeStart" value="1" min="1" style="width: 100%; text-align: center; margin: 0;">
</div>
<div style="flex: 1;">
<label for="rangeEnd">Ù†Ù‡Ø§ÙŠØ© Ù…Ø¯Ù‰ Ø§Ù„ØªØ±Ù‚ÙŠÙ… (Ù…Ø«Ù„ 40):</label>
<input type="number" id="rangeEnd" value="1000" min="1" style="width: 100%; text-align: center; margin: 0;">
</div>
</div>
<div style="display: flex; gap: 20px; margin-bottom: 20px;">
<div style="flex: 1;">
<label for="tfCountInput">ØµÙˆØ§Ø¨/Ø®Ø·Ø£ (Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨):</label>
<div style="display: flex; align-items: center; gap: 5px;">
<button class="secondary-btn" onclick="updateQuestionCount('tfCountInput', -1)" style="padding: 10px 15px; margin: 0;">-</button>
<input type="number" id="tfCountInput" value="0" min="0" style="width: 100%; text-align: center; margin: 0;">
<button class="secondary-btn" onclick="updateQuestionCount('tfCountInput', 1)" style="padding: 10px 15px; margin: 0;">+</button>
</div>
</div>
<div style="flex: 1;">
<label for="mcCountInput">Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ (Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨):</label>
<div style="display: flex; align-items: center; gap: 5px;">
<button class="secondary-btn" onclick="updateQuestionCount('mcCountInput', -1)" style="padding: 10px 15px; margin: 0;">-</button>
<input type="number" id="mcCountInput" value="0" min="0" style="width: 100%; text-align: center; margin: 0;">
<button class="secondary-btn" onclick="updateQuestionCount('mcCountInput', 1)" style="padding: 10px 15px; margin: 0;">+</button>
</div>
</div>
</div>
<button class="primary-btn" style="width: 100%;" onclick="startExam()">ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
</div>
</div>
<div id="examSection" class="hidden">
<h2 id="examTitle"></h2>
<div id="timer">â±ï¸ 00:00</div>
<div id="examQuestions">
</div>
<div id="shareControls" style="display: none; margin-top: 30px; padding: 20px; border: 1px solid #007bff; border-radius: 8px; background-color: #f0f8ff;">
<p style="font-weight: bold; margin-bottom: 10px; color: #007bff;">ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© (ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©):</p>
<div style="display: flex; gap: 10px; align-items: center;">
<input type="text" id="examLinkInput" readonly style="flex-grow: 1; padding: 10px; border: 1px solid #007bff; border-radius: 4px; background-color: white;">
<button id="copyLinkBtn" onclick="copyExamLink()" style="padding: 10px 18px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer;">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
<button id="toggleQRBtn" onclick="toggleQRCode()" style="padding: 10px 18px; background-color: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer;">Ø±Ù…Ø² QR</button>
</div>
<div id="qrCodeContainer" style="text-align: center; margin-top: 15px; padding: 15px; border: 1px dashed #ccc; border-radius: 4px; background-color: white; display: none;">
<div id="qrcode"></div>
<p style="font-size: 0.8em; color: #555; margin-top: 10px;">Ø§Ù…Ø³Ø­ Ø§Ù„Ø±Ù…Ø² Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
</div>
</div>
<div style="text-align: center; margin-top: 30px;">
<button class="primary-btn" onclick="submitExam(false)">âœ… Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
</div>
</div>
<div id="resultsSection" class="hidden">
<div id="scoreDisplay" class="controls" style="font-size: 1.2em; text-align: center;">
</div>
<div id="detailedResults">
</div>
<div style="text-align: center; margin-top: 30px; margin-bottom: 30px;">
<button class="primary-btn" onclick="saveResults()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø¨Ø§Ù„ØªÙØµÙŠÙ„</button>
<button class="primary-btn" onclick="printResults()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
<button class="secondary-btn" onclick="resetExam()">ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯</button>
</div>
</div>
</div>
<div id="schoolAnalysisContainer" class="hidden">
<button class="secondary-btn" onclick="hideSchoolAnalysis()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
<div id="schoolAnalysisControls" class="controls" style="margin-top: 30px; border-color: #28a745;">
<h3>ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©/Ø§Ù„ÙØµÙˆÙ„ (Ù†ØªØ§Ø¦Ø¬ Ù…ØªØ¹Ø¯Ø¯Ø©)</h3>
<label>ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ (JSON):</label>
<input type="file" id="schoolResultsUpload" accept=".json" multiple onchange="handleSchoolResultsUpload()" style="margin-bottom: 10px;">
<button class="primary-btn" onclick="analyzeSchoolPerformance()" style="width: 100%; margin: 0 0 10px 0;">ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©/Ø§Ù„ÙØµÙˆÙ„</button>
<div id="downloadPrintButtons" style="display: flex; gap: 10px;">
<button class="primary-btn" style="flex-grow: 1; background-color: #dc3545;" onclick="downloadSchoolAnalysisPDF()">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ ØªØ­Ù„ÙŠÙ„ ÙƒÙ€ PDF</button>
<button class="secondary-btn" style="flex-grow: 1;" onclick="printSchoolAnalysis()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
</div>
<div id="schoolAnalysisOutput" class="hidden" style="margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 15px;">
</div>
</div>
</div>
<div id="a4TestBuilder" class="hidden">
<button class="secondary-btn" onclick="hideA4TestBuilder()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
<h2>ğŸ“ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠ Ø£Ùˆ Ø´Ù‡Ø±ÙŠ (Ù†Ù…ÙˆØ°Ø¬ A4)</h2>
<div class="controls form-section" id="klisheh-section">
<h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ´Ø© (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„)</h3>
<div style="display: flex; gap: 10px;">
<input type="text" id="countryName" value="Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆÙ„Ø©/Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">
<input type="text" id="schoolName" value="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">
</div>
<div style="display: flex; gap: 10px;">
<input type="text" id="examSubject" value="Ø§Ù„Ù…Ø§Ø¯Ø©" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø©">
<input type="text" id="examDurationA4" value="Ø³Ø§Ø¹Ø© ÙˆÙ†ØµÙ" placeholder="Ø§Ù„Ø²Ù…Ù†">
</div>
<div style="display: flex; gap: 10px; align-items: center;">
<input type="number" id="totalGrade" value="40" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©" min="1" style="width: 150px;">
<input type="text" id="examTitleA4" value="Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù„Ù„Ø¹Ø§Ù… 1446 Ù‡Ù€" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±" style="flex-grow: 1;">
</div>
<label for="uploadLogo">ØªØ­Ù…ÙŠÙ„/ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø¹Ø§Ø± (Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ²Ø§Ø±Ø©/Ø§Ù„ØªØ¹Ù„ÙŠÙ…):</label>
<input type="file" id="uploadLogo" accept="image/*" class="secondary-btn">
<div id="klishehPreview" style="border: 1px dashed #007bff; padding: 15px; margin-top: 15px; text-align: center; font-size: 0.9em; background-color: #f0f8ff;">
<p>Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§Ø­Ø© (4-5 Ø³Ù…) Ù…Ø®ØµØµØ© Ù„Ù„ÙƒÙ„ÙŠØ´Ø©. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ A4 Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ.</p>
</div>
</div>
<div class="controls form-section">
<h3>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„Ù†Ù…ÙˆØ°Ø¬ A4</h3>
<button class="primary-btn" onclick="addA4QuestionType('mcq')">â• Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ / ØµØ­ Ùˆ Ø®Ø·Ø£</button>
<button class="primary-btn" onclick="addA4QuestionType('essay')">â• Ù…Ù‚Ø§Ù„ÙŠØ© (Ø¹Ø±Ù/Ø¹Ù„Ù„/Ø§Ø´Ø±Ø­)</button>
<button class="primary-btn" onclick="addA4QuestionType('matching')">â• Ø³Ø¤Ø§Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ù†</button>
<p style="font-size: 0.9em; color: #dc3545;">Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ù†ØŒ ÙŠØ±Ø¬Ù‰ ØªØ¬Ù‡ÙŠØ²Ù‡Ø§ Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© **Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØªØ¹Ø¯ÙŠÙ„Ù‡Ø§**.</p>
</div>
<div id="a4QuestionsList">
</div>
<div class="controls form-section" style="text-align: center;">
<h3>ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬</h3>
<button class="primary-btn" onclick="saveA4Draft()">ğŸ’¾ Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø© Ø§Ù„Ø¹Ù…Ù„</button>
<button class="primary-btn" onclick="printA4Test()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù†Ù…ÙˆØ°Ø¬ A4</button>
<button class="primary-btn" onclick="downloadA4Test('pdf')">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ ÙƒÙ€ PDF</button>
<button class="primary-btn" onclick="downloadA4Test('docx')">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ ÙƒÙ€ DOCX</button>
</div>
</div>
<div id="remedialPlanContainer" class="hidden">
<button class="secondary-btn" onclick="hideRemedialPlan()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
<div id="remedialPlanForm" class="controls form-section" style="margin-top: 30px; border-color: #007bff;">
<h3>ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ / Ø§Ù„Ø·Ø§Ù„Ø¨Ø© (Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®ØµØµ)</h3>
<label for="remedial_logo_upload">ØªØ­Ù…ÙŠÙ„ Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ²Ø§Ø±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±):</label>
<div style="display: flex; gap: 10px; align-items: center;">
<input type="file" id="remedial_logo_upload" accept="image/*" style="flex-grow: 1;" onchange="handleRemedialLogoUpload()">
<button class="secondary-btn" onclick="removeRemedialLogo()" style="background-color: #dc3545; display: inline-block;">Ø­Ø°Ù Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
</div>
<hr style="margin: 20px 0;">
<div style="display: flex; gap: 10px;">
<input type="text" id="remedial_teacherName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… / Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù…ÙØ¹Ø¯ Ù„Ù„Ø®Ø·Ø©" value="" required>
<input type="text" id="remedial_subject" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø©" value="" required>
<input type="text" id="remedial_class" placeholder="Ø§Ù„ØµÙ/Ø§Ù„ÙØµÙ„" value="" required>
</div>
<label for="remedial_studentName">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ / Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
<input type="text" id="remedial_studentName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø·Ø§Ù„Ø¨/Ø©" required>
<label for="remedial_date">ØªØ§Ø±ÙŠØ® Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø·Ø©:</label>
<input type="text" id="remedial_date" readonly style="background-color: #f1f1f1;">
<hr style="margin: 20px 0;">
<h4>Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ø§Ù„ØªÙŠ ØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡Ø§:</h4>
<div class="remedial-list" id="weaknessList">
</div>
<h4>Ø·Ø±Ù‚ ÙˆØ£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:</h4>
<div class="remedial-list" id="methodsList">
</div>
<h4>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø§Ù„Ù…ØªØ®Ø°Ø©/Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:</h4>
<div class="remedial-list" id="actionsList">
</div>
<hr style="margin: 20px 0;">
<div style="display: flex; gap: 20px;">
<div style="flex: 1;">
<label for="remedial_improvementResult">Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ø³Ù† Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©/Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</label>
<select id="remedial_improvementResult" required>
    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù†ØªÙŠØ¬Ø© --</option>
</select>
</div>
<div style="flex: 1;">
<label for="remedial_directorName">Ø§Ø³Ù… Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© / Ø§Ù„Ù…Ø¯ÙŠØ±Ø©:</label>
<input type="text" id="remedial_directorName" placeholder="Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© / Ø§Ù„Ù…Ø¯ÙŠØ±Ø© Ù„Ù„ØªÙˆÙ‚ÙŠØ¹" value="Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© / Ø§Ù„Ù…Ø¯ÙŠØ±Ø©">
</div>
</div>
<label for="remedial_notes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©:</label>
<textarea id="remedial_notes" rows="3" placeholder="Ø£Ø¶Ù Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­ÙˆÙ„ Ø§Ù„Ø®Ø·Ø©..."></textarea>
<div style="display: flex; gap: 10px; margin-top: 20px;">
<button class="primary-btn" style="flex-grow: 1; background-color: #009688;" onclick="printRemedialPlan()">ğŸ–¨ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙØ­Ø© (Ø·Ø¨Ø§Ø¹Ø©/Ø­ÙØ¸ PDF)</button>
<button class="primary-btn" style="flex-grow: 1; background-color: #dc3545;" onclick="generateRemedialPlanPDF()">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ ÙƒÙ€ PDF (Ù…ÙˆØ«ÙˆÙ‚)</button>
</div>
</div>
</div>
</div>
<div class="pdf-content-remedial-print"></div>
<script>
let tfQuestionCount = 0;
let mcQuestionCount = 0;
let examTimer;
let examData = { name: '', duration: 0, questions: [], submissionDeadline: null, studentName: '' };
window.currentResults = null;
window.schoolResults = [];
let remedialLogoDataURL = null; // Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø´Ø¹Ø§Ø± Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©
const correctTagsRegex = [
/<<<ØµØ­ÙŠØ­>>>/gi,
/\[ØµØ­ÙŠØ­\]/gi,
/\*\*\*ØµØ­ÙŠØ­\*\*\*/gi,
/\[ØµÙˆØ§Ø¨\]/gi,
/\[Ø®Ø·Ø£\]/gi,
/\*\*/g, // Ù†Ø¬Ù…Ø© Ù…Ø²Ø¯ÙˆØ¬Ø©
/\*/g, // Ù†Ø¬Ù…Ø© Ù…ÙØ±Ø¯Ø©
/âœ…/g, // Ø¹Ù„Ø§Ù…Ø© ØµØ­ ÙŠÙˆÙ†ÙŠÙƒÙˆØ¯
/âŒ/g, // Ø¹Ù„Ø§Ù…Ø© Ø®Ø·Ø£ ÙŠÙˆÙ†ÙŠÙƒÙˆØ¯
/ØµØ­ÙŠØ­/gi,
/ØµØ­/gi,
/Ø®Ø·Ø£/gi,
/ØºÙ„Ø·/gi
];
const allTagsPattern = new RegExp(correctTagsRegex.map(r => r.source).join('|'), 'gi');
const MC_MAX_OPTIONS = 6;
const MC_LETTERS = ['Ø£', 'Ø¨', 'Ø¬', 'Ø¯', 'Ù‡Ù€', 'Ùˆ'];
// ğŸ†• Ù‚ÙˆØ§Ø¦Ù… Ø¹Ø§Ù…Ø© Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© (Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø¯) ğŸ†•
const generalRemedialLists = {
    weaknesses: [
        "Ø¶Ø¹Ù ÙÙŠ Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…Ø§Ø¯Ø©.",
        "ØµØ¹ÙˆØ¨Ø© ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.",
        "Ù†Ù‚Øµ ÙÙŠ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙ†ØªØ§Ø¬.",
        "Ø¨Ø·Ø¡ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆØ§Ù„ÙÙ‡Ù… Ù„Ù„Ù†ØµÙˆØµ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©.",
        "Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø£Ùˆ Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø·Ù‚ÙŠ.",
        "Ø§Ù„Ø§Ø±ØªØ¨Ø§Ùƒ ÙˆØ¹Ø¯Ù… Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±.",
        "Ø¶Ø¹Ù ÙÙŠ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª."
    ],
    methods: [
        "Ø´Ø±Ø­ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø¨Ø·Ø±Ù‚ Ù…Ø¨Ø³Ø·Ø© ÙˆØ¥ÙŠØ¶Ø§Ø­Ù‡Ø§ Ø¨Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ø£Ùˆ Ø§Ù„Ø®Ø±Ø§Ø¦Ø· Ø§Ù„Ø°Ù‡Ù†ÙŠØ©.",
        "ØªÙƒÙ„ÙŠÙ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù…Ù‡Ø§Ù… Ù…Ø­Ø¯Ø¯Ø© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ Ù„Ø±ÙØ¹ Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ.",
        "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙˆØ§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ø±Ø¨Ø· Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø¨Ø§Ù„ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠ.",
        "ØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© Ù‡Ø§Ø¯Ø¦Ø© ÙˆØ¯Ø§Ø¹Ù…Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨.",
        "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠ Ù„Ù…Ù†Ø§Ù‚Ø´Ø© Ø§Ù„ØµØ¹ÙˆØ¨Ø§Øª Ù…Ø¹ Ø§Ù„Ø²Ù…Ù„Ø§Ø¡.",
        "ØªØ¬Ø²Ø¦Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ø¥Ù„Ù‰ Ù…Ù‡Ø§Ù… ØµØºÙŠØ±Ø© ÙŠØ³Ù‡Ù„ Ø¥Ù†Ø¬Ø§Ø²Ù‡Ø§.",
        "Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙ„Ø®ÙŠØµ ÙˆØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠ Ø¬Ø¯Ø§ÙˆÙ„."
    ],
    actions: [
        "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ø§Ø¯Ø© Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.",
        "ØªÙˆÙÙŠØ± Ù†Ù…Ø§Ø°Ø¬ Ø¬Ø§Ù‡Ø²Ø© Ù„Ø­Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ÙˆØªÙˆØ¶ÙŠØ­ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©.",
        "Ø²ÙŠØ§Ø¯Ø© ÙˆÙ‚Øª Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙƒØ«ÙØ© Ø¨Ù…Ø¹Ø¯Ù„ Ù…Ø±ØªÙŠÙ† Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹.",
        "Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù‚ØµÙŠØ±Ø© (Quiz) Ù…Ù†ØªØ¸Ù…Ø© Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªÙ‚Ø¯Ù….",
        "ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù‰ Ø·Ø±Ø­ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø§Ø· Ø§Ù„ØºÙ…ÙˆØ¶.",
        "Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„.",
        "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (Flash Cards) Ù„Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©."
    ],
    improvementResults: [
        "ØªØ­Ø³Ù† Ø³Ø±ÙŠØ¹ ÙˆÙ…Ù„Ù…ÙˆØ³",
        "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹ (ØªØ­Ø³Ù† Ù…Ø³ØªÙ…Ø±)",
        "Ø¬ÙŠØ¯ (ØªØ­Ø³Ù† Ø¨Ø·ÙŠØ¡)",
        "Ø¨Ø·ÙŠØ¡ / Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ø³Ù† Ø¨Ø¹Ø¯"
    ]
};
// ğŸ†• Ù†Ù‡Ø§ÙŠØ© Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© ğŸ†•
function populateRemedialLists() {
    const lists = generalRemedialLists;

    // 1. Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù
    const weaknessListEl = document.getElementById('weaknessList');
    weaknessListEl.innerHTML = ''; 
    lists.weaknesses.forEach((item, index) => {
        weaknessListEl.innerHTML += `
            <label>
                <input type="checkbox" name="weakness" value="${item}">
                ${item}
            </label>
        `;
    });

    // 2. Ø·Ø±Ù‚ ÙˆØ£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ø¹Ù„Ø§Ø¬
    const methodsListEl = document.getElementById('methodsList');
    methodsListEl.innerHTML = ''; 
    lists.methods.forEach((item, index) => {
        methodsListEl.innerHTML += `
            <label>
                <input type="checkbox" name="method" value="${item}">
                ${item}
            </label>
        `;
    });

    // 3. Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø§Ù„Ù…ØªØ®Ø°Ø©/Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©
    const actionsListEl = document.getElementById('actionsList');
    actionsListEl.innerHTML = ''; 
    lists.actions.forEach((item, index) => {
        actionsListEl.innerHTML += `
            <label>
                <input type="checkbox" name="action" value="${item}">
                ${item}
            </label>
        `;
    });

    // 4. Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ø³Ù†
    const resultSelectEl = document.getElementById('remedial_improvementResult');
    const selectedValue = resultSelectEl.value; 
    resultSelectEl.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù†ØªÙŠØ¬Ø© --</option>'; 
    lists.improvementResults.forEach((item, index) => {
        const isSelected = item === selectedValue ? 'selected' : '';
        resultSelectEl.innerHTML += `
            <option value="${item}" ${isSelected}>${item}</option>
        `;
    });
}
document.addEventListener('DOMContentLoaded', populateRemedialLists);

function shuffleArray(array) {
for (let i = array.length - 1; i > 0; i--) {
const j = Math.floor(Math.random() * (i + 1));
[array[i], array[j]] = [array[j], array[i]];
}
return array;
}
function getFeedbackMessage(percentage) {
if (percentage >= 90) {
return { message: "Ø£Ø¯Ø§Ø¡ Ù…ØªÙ…ÙŠØ²! Ù†ØªÙŠØ¬Ø© Ù…Ù…ØªØ§Ø²Ø©.", icon: "ğŸŒŸ" };
} else if (percentage >= 80) {
return { message: "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹.", icon: "ğŸ‘" };
} else if (percentage >= 70) {
return { message: "Ø¬ÙŠØ¯. ØªØ­ØªØ§Ø¬ Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø®ÙÙŠÙØ©.", icon: "ğŸ‘" };
} else if (percentage >= 50) {
return { message: "ÙŠØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø©.", icon: "ğŸ“š" };
} else {
return { message: "Ù†ØªÙŠØ¬Ø© Ø¶Ø¹ÙŠÙØ©. ÙŠØ¬Ø¨ Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ø¨Ø¬Ø¯ Ø£ÙƒØ¨Ø±.", icon: "ğŸ˜”" };
}
}
function updateDeadlineInfo() {
const days = parseInt(document.getElementById('submissionDays').value) || 7;
const deadline = new Date();
deadline.setDate(deadline.getDate() + days);
document.getElementById('deadlineInfo').innerHTML = `
<strong>ğŸ“… Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„ØªØ³Ù„ÙŠÙ…:</strong> ${deadline.toLocaleDateString('ar-EG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
`;
examData.submissionDeadline = deadline;
}
document.getElementById('submissionDays').addEventListener('change', updateDeadlineInfo);
function switchTab(tabName) {
document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
const clickedButton = event ? event.currentTarget : document.querySelector(`.tab[data-tab-name="${tabName}"]`);
if (clickedButton) clickedButton.classList.add('active');
document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
document.getElementById(tabName + 'Tab').classList.add('active');
}
function updateQuestionCount(elementId, change) {
const inputElement = document.getElementById(elementId);
let currentValue = parseInt(inputElement.value) || 0;
let newValue = currentValue + change;
if (newValue < 0) {
newValue = 0;
}
inputElement.value = newValue;
}
function handleFileUpload() {
const file = document.getElementById('fileUpload').files[0];
if (!file) return;
document.querySelector('.file-upload-area p:first-child').textContent = `âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù: ${file.name}`;
if (file.type === 'application/pdf') {
loadQuestionsFromPDF(file);
} else if (file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {
loadQuestionsFromDOCX(file);
} else if (file.type === 'text/plain') {
loadQuestionsFromFile(file);
} else {
alert('âš ï¸ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù .txt Ø£Ùˆ .pdf Ø£Ùˆ .docx');
}
}
function loadQuestionsFromFile(file) {
const reader = new FileReader();
reader.onload = function (e) {
try {
const content = e.target.result;
processQuestionsContent(content);
} catch (error) {
alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†ØµÙŠ: ' + error.message);
}
};
reader.readAsText(file, 'UTF-8');
}
async function loadQuestionsFromPDF(file) {
try {
if (typeof pdfjsLib === 'undefined') {
alert('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© PDF.js. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.');
return;
}
const arrayBuffer = await file.arrayBuffer();
const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
let textContent = '';
for (let i = 1; i <= pdf.numPages; i++) {
const page = await pdf.getPage(i);
const text = await page.getTextContent();
textContent += text.items.map(item => item.str).join(' ') + '\n';
}
if (textContent.trim().length === 0) {
alert('Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Øµ ØµØ§Ù„Ø­.');
return;
}
processQuestionsContent(textContent);
} catch (error) {
console.error(error);
alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„Ù PDF: ' + error.message);
}
}
async function loadQuestionsFromDOCX(file) {
try {
if (typeof mammoth === 'undefined') {
alert('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Mammoth.js. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.');
return;
}
const arrayBuffer = await file.arrayBuffer();
const result = await mammoth.extractRawText({ arrayBuffer: arrayBuffer });
const textContent = result.value;
if (textContent.trim().length === 0) {
alert('Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Øµ ØµØ§Ù„Ø­.');
return;
}
processQuestionsContent(textContent);
} catch (error) {
console.error(error);
alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„Ù DOCX: ' + error.message);
}
}
function processQuestionsContent(content) {
// Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø©
const lines = content.split('\n').map(line => line.trim()).filter(line => line.length > 0);
if (lines.length === 0) {
alert('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù.');
return;
}
let newQuestions = [];
let currentQuestion = null;
let currentOptions = [];
let questionType = null;
let lineNumber = 0;
// Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³Ø·Ø± ÙŠÙ…Ø«Ù„ Ø®ÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø©
const isOption = (line) => {
// Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© ØªÙƒÙˆÙ† Ø¹Ø§Ø¯Ø©Ù‹ Ù…Ø±Ù‚Ù…Ø© Ø¨Ø­Ø±Ù Ø£Ùˆ Ø±Ù‚Ù…
return /^[Ø£-Ùˆ] |^\([Ø£-Ùˆ]\) |^\d\./.test(line);
};
const finalizeQuestion = () => {
if (currentQuestion) {
const questionText = currentQuestion.replace(allTagsPattern, '').trim();
let correctAnswer = null;
let isTF = false;
// ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„
if (currentOptions.length === 0) {
// Ø§ÙØªØ±Ø§Ø¶ Ø³Ø¤Ø§Ù„ ØµÙˆØ§Ø¨/Ø®Ø·Ø£ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø®ÙŠØ§Ø±Ø§Øª
isTF = true;
// Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù„Ø§Ù…Ø© "ØµØ­ÙŠØ­" Ø£Ùˆ "Ø®Ø·Ø£" ÙÙŠ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ØµÙ„ÙŠ
const originalText = currentQuestion;
if (/\*|\[ØµÙˆØ§Ø¨\]|ØµØ­ÙŠØ­|âœ…/i.test(originalText)) {
correctAnswer = 'ØµÙˆØ§Ø¨';
} else if (/\[Ø®Ø·Ø£\]|Ø®Ø·Ø£|âŒ/i.test(originalText)) {
correctAnswer = 'Ø®Ø·Ø£';
} else {
// Ø§ÙØªØ±Ø§Ø¶ ØµÙˆØ§Ø¨ ÙƒÙ‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØªØ­Ø±ÙŠØ± Ù„Ø§Ø­Ù‚Ø§Ù‹
correctAnswer = 'ØµÙˆØ§Ø¨'; 
}
} else {
// Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯
let finalOptions = currentOptions.map(opt => opt.replace(allTagsPattern, '').trim());
let correctIndex = -1;
currentOptions.forEach((opt, index) => {
if (allTagsPattern.test(opt)) {
correctIndex = index;
}
});
if (correctIndex !== -1) {
correctAnswer = finalOptions[correctIndex];
} else {
// ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„ ÙƒØµØ­ÙŠØ­ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
correctAnswer = finalOptions[0];
}
newQuestions.push({
id: `mc-${mcQuestionCount++}`,
type: 'mc',
text: questionText,
options: finalOptions,
correctAnswer: correctAnswer
});
currentQuestion = null;
currentOptions = [];
return; // Ø§Ù†ØªÙ‡ÙŠÙ†Ø§ Ù…Ù† MC
}
if (isTF) {
newQuestions.push({
id: `tf-${tfQuestionCount++}`,
type: 'tf',
text: questionText,
correctAnswer: correctAnswer // Ø³ÙŠÙƒÙˆÙ† 'ØµÙˆØ§Ø¨' Ø£Ùˆ 'Ø®Ø·Ø£'
});
}
currentQuestion = null;
currentOptions = [];
}
};
// Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø·ÙˆØ± Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
for (const line of lines) {
lineNumber++;
if (/^\d{1,3}\./.test(line) || /^Ø³\d{1,3}:/.test(line) || /^Ø§Ù„Ø³Ø¤Ø§Ù„\s+\d{1,3}:/.test(line)) {
// Ø¨Ø¯Ø§ÙŠØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯ (Ù…Ø±Ù‚Ù…)
finalizeQuestion();
currentQuestion = line.replace(/^\d{1,3}\./, '').replace(/^Ø³\d{1,3}:/, '').trim();
currentOptions = [];
} else if (currentQuestion && (line.startsWith('(') && line.endsWith(')'))) {
// Ø³Ø·Ø± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø®ÙŠØ§Ø±Ø§Øª MC (Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹)
// ÙŠÙ…ÙƒÙ† ØªØ¬Ø§Ù‡Ù„Ù‡Ø§ Ø£Ùˆ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ù…Ø¬Ù‡Ø§ ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„
} else if (currentQuestion && (isOption(line) || currentOptions.length > 0 && line.length < 50)) {
// Ø®ÙŠØ§Ø± Ù„Ø³Ø¤Ø§Ù„ Ø³Ø§Ø¨Ù‚ (Ø¬Ù…Ø¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª)
currentOptions.push(line);
} else {
// Ø³Ø·Ø± Ø¥Ø¶Ø§ÙÙŠ Ù†ØµÙŠ (Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø¬Ø²Ø¡Ù‹Ø§ Ù…Ù† Ø§Ù„Ø³Ø¤Ø§Ù„)
if (currentQuestion) {
currentQuestion += ' ' + line;
}
}
}
finalizeQuestion(); // Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„
// ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
if (newQuestions.length > 0) {
newQuestions.forEach(q => {
if (q.type === 'tf') {
addTFQuestion(q.text, q.correctAnswer);
} else if (q.type === 'mc') {
addMCQuestion(q.text, q.options, q.correctAnswer);
}
});
alert(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ÙˆØ¥Ø¶Ø§ÙØ© ${newQuestions.length} Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!`);
} else {
alert('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚.');
}
}
function addTFQuestion(text = '', answer = 'ØµÙˆØ§Ø¨') {
const container = document.getElementById('tfQuestions');
const newId = tfQuestionCount++;
const tfQuestionHTML = `
<div class="question-container" id="tf-q-${newId}" data-id="${newId}" data-type="tf">
<div class="question-header">
<span class="question-number">Ø³Ø¤Ø§Ù„ ØµÙˆØ§Ø¨/Ø®Ø·Ø£ Ø¬Ø¯ÙŠØ¯ (${newId})</span>
<button class="delete-btn" onclick="deleteQuestion('tf-q-${newId}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
</div>
<label>Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
<textarea id="tf-text-${newId}" rows="3" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§...">${text}</textarea>
<label>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</label>
<div style="display: flex; gap: 15px;">
<label style="font-weight: normal;"><input type="radio" name="tf-answer-${newId}" value="ØµÙˆØ§Ø¨" ${answer === 'ØµÙˆØ§Ø¨' ? 'checked' : ''}> ØµÙˆØ§Ø¨</label>
<label style="font-weight: normal;"><input type="radio" name="tf-answer-${newId}" value="Ø®Ø·Ø£" ${answer === 'Ø®Ø·Ø£' ? 'checked' : ''}> Ø®Ø·Ø£</label>
</div>
</div>
`;
container.insertAdjacentHTML('beforeend', tfQuestionHTML);
}
function addMCQuestion(text = '', options = ['', '', ''], correctOption = '') {
const container = document.getElementById('mcQuestions');
const newId = mcQuestionCount++;
const questionDiv = document.createElement('div');
questionDiv.className = 'question-container';
questionDiv.id = `mc-q-${newId}`;
questionDiv.dataset.id = newId;
questionDiv.dataset.type = 'mc';
const optionsListHTML = options.map((opt, index) => {
const isCorrect = opt === correctOption || (options.length > 0 && correctOption === '' && index === 0);
return `
<div class="option-input">
<input type="radio" name="mc-answer-${newId}" value="${MC_LETTERS[index]}" ${isCorrect ? 'checked' : ''} data-option-value="${opt}">
<input type="text" id="mc-option-${newId}-${index}" value="${opt}" placeholder="Ø®ÙŠØ§Ø± ${MC_LETTERS[index]}">
<button class="option-delete-btn" onclick="deleteMCOption('mc-q-${newId}', this)">âŒ Ø­Ø°Ù Ø§Ù„Ø®ÙŠØ§Ø±</button>
</div>
`;
}).join('');
questionDiv.innerHTML = `
<div class="question-header">
<span class="question-number">Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ Ø¬Ø¯ÙŠØ¯ (${newId})</span>
<button class="delete-btn" onclick="deleteQuestion('mc-q-${newId}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
</div>
<label>Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
<textarea id="mc-text-${newId}" rows="3" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§...">${text}</textarea>
<label>Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª (Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ):</label>
<div class="options-list" id="mc-options-list-${newId}">
${optionsListHTML}
</div>
<button class="secondary-btn" onclick="addMCOption('mc-q-${newId}')" style="margin-top: 10px;">â• Ø¥Ø¶Ø§ÙØ© Ø®ÙŠØ§Ø± Ø¬Ø¯ÙŠØ¯</button>
`;
container.appendChild(questionDiv);
// ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ù€ data-option-value Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
questionDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
radio.dataset.optionValue = radio.nextElementSibling.value;
});
// Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„ØªØºÙŠÙŠØ± Ù„ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ù€ Radio Button
questionDiv.querySelectorAll('.option-input input[type="text"]').forEach(input => {
input.addEventListener('input', function() {
this.previousElementSibling.dataset.optionValue = this.value;
});
});
}
function addMCOption(questionId) {
const questionDiv = document.getElementById(questionId);
const optionsList = questionDiv.querySelector('.options-list');
const optionCount = optionsList.children.length;
const questionNum = questionDiv.dataset.id;
if (optionCount >= MC_MAX_OPTIONS) {
alert(`âš ï¸ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù‡Ùˆ ${MC_MAX_OPTIONS}.`);
return;
}
const newOptionHTML = `
<div class="option-input">
<input type="radio" name="mc-answer-${questionNum}" value="${MC_LETTERS[optionCount]}" data-option-value="">
<input type="text" id="mc-option-${questionNum}-${optionCount}" value="" placeholder="Ø®ÙŠØ§Ø± ${MC_LETTERS[optionCount]}">
<button class="option-delete-btn" onclick="deleteMCOption('${questionId}', this)">âŒ Ø­Ø°Ù Ø§Ù„Ø®ÙŠØ§Ø±</button>
</div>
`;
optionsList.insertAdjacentHTML('beforeend', newOptionHTML);
// Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø§Ù„ØªØºÙŠÙŠØ± Ù„Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
const newOptionInput = optionsList.lastElementChild.querySelector('input[type="text"]');
newOptionInput.addEventListener('input', function() {
this.previousElementSibling.dataset.optionValue = this.value;
});
}
function deleteMCOption(questionId, button) {
const optionInputDiv = button.closest('.option-input');
const isChecked = optionInputDiv.querySelector('input[type="radio"]').checked;
optionInputDiv.remove();
const optionsList = document.getElementById(questionId).querySelector('.options-list');
// Ø¥Ø¹Ø§Ø¯Ø© ØªØ±Ù‚ÙŠÙ… Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙˆØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ù€ value ÙÙŠ Radio Buttons
optionsList.querySelectorAll('.option-input').forEach((inputDiv, index) => {
const radio = inputDiv.querySelector('input[type="radio"]');
const textInput = inputDiv.querySelector('input[type="text"]');
// Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ±Ù‚ÙŠÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø­Ø±ÙˆÙ
radio.value = MC_LETTERS[index];
// ØªØ­Ø¯ÙŠØ« placeholder ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ù€ data-option-value
textInput.placeholder = `Ø®ÙŠØ§Ø± ${MC_LETTERS[index]}`;
textInput.id = `mc-option-${questionId.split('-')[2]}-${index}`;
// ÙÙŠ Ø­Ø§Ù„Ø© Ø­Ø°Ù Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„ØµØ­ÙŠØ­ØŒ ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„ ÙƒØµØ­ÙŠØ­ Ø¨Ø´ÙƒÙ„ Ù…Ø¤Ù‚Øª
if (isChecked && index === 0) {
radio.checked = true;
}
});
// Ø¥Ø°Ø§ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„ØµØ­ÙŠØ­ ÙˆÙ„Ù… ÙŠØªØ¨Ù‚ Ø®ÙŠØ§Ø±Ø§ØªØŒ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙƒØµØ­ÙŠØ­
if (isChecked && optionsList.children.length > 0) {
optionsList.firstElementChild.querySelector('input[type="radio"]').checked = true;
}
}
function deleteQuestion(questionId) {
if (confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ')) {
document.getElementById(questionId).remove();
}
}
function saveExam() {
const examName = document.getElementById('examName').value.trim();
const duration = parseInt(document.getElementById('examDuration').value);
if (!examName || isNaN(duration) || duration <= 0) {
alert('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆÙ…Ø¯Ø© ØµØ§Ù„Ø­Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±!');
return;
}
let questions = [];
// Ø¬Ù…Ø¹ Ø£Ø³Ø¦Ù„Ø© ØµÙˆØ§Ø¨/Ø®Ø·Ø£
document.querySelectorAll('#tfQuestions .question-container').forEach(qDiv => {
const id = qDiv.dataset.id;
const text = document.getElementById(`tf-text-${id}`).value.trim();
const answer = document.querySelector(`input[name="tf-answer-${id}"]:checked`).value;
if (text) {
questions.push({
id: `tf-${id}`,
type: 'tf',
text: text,
correctAnswer: answer,
answer: null // Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨
});
}
});
// Ø¬Ù…Ø¹ Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯
document.querySelectorAll('#mcQuestions .question-container').forEach(qDiv => {
const id = qDiv.dataset.id;
const text = document.getElementById(`mc-text-${id}`).value.trim();
const options = Array.from(qDiv.querySelectorAll('.option-input input[type="text"]')).map(input => input.value.trim()).filter(val => val !== '');
const correctRadio = qDiv.querySelector(`input[name="mc-answer-${id}"]:checked`);
const correctOptionValue = correctRadio ? correctRadio.dataset.optionValue.trim() : null;
if (text && options.length >= 2 && correctOptionValue) {
questions.push({
id: `mc-${id}`,
type: 'mc',
text: text,
options: options,
correctAnswer: correctOptionValue,
answer: null
});
} else if (text && options.length < 2) {
alert(`âš ï¸ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø±Ù‚Ù… (${id}) Ù…Ù† Ù†ÙˆØ¹ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ ÙŠØ­ØªØ§Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø®ÙŠØ§Ø±ÙŠÙ†.`);
return;
}
});
if (questions.length === 0) {
alert('âŒ ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸!');
return;
}
examData.name = examName;
examData.duration = duration;
examData.questions = questions;
updateDeadlineInfo(); // Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
const dataStr = JSON.stringify(examData, null, 2);
const blob = new Blob([dataStr], { type: 'application/json' });
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = `${examName}_ExamData_${new Date().toISOString().slice(0, 10)}.json`;
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
alert('âœ… ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­!');
}
function loadSavedExam() {
const file = document.getElementById('loadExamFile').files[0];
if (!file) return;
const reader = new FileReader();
reader.onload = function (e) {
try {
const loadedData = JSON.parse(e.target.result);
if (loadedData.name && loadedData.questions) {
examData = loadedData;
document.getElementById('examName').value = examData.name;
document.getElementById('examDuration').value = examData.duration;
if (examData.submissionDeadline) {
const now = new Date();
const deadline = new Date(examData.submissionDeadline);
const diffTime = Math.abs(deadline - now);
const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
document.getElementById('submissionDays').value = diffDays;
}
updateDeadlineInfo();
loadQuestionsToUI(examData.questions);
alert(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± "${examData.name}" Ø¨Ù†Ø¬Ø§Ø­!`);
} else {
alert('âŒ ØªÙ†Ø³ÙŠÙ‚ Ù…Ù„Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØºÙŠØ± ØµØ­ÙŠØ­.');
}
} catch (error) {
alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù: ' + error.message);
}
};
reader.readAsText(file);
}
function loadQuestionsToUI(questions) {
// Ù…Ø³Ø­ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
document.getElementById('tfQuestions').innerHTML = '';
document.getElementById('mcQuestions').innerHTML = '';
tfQuestionCount = 0;
mcQuestionCount = 0;
questions.forEach(q => {
if (q.type === 'tf') {
addTFQuestion(q.text, q.correctAnswer);
} else if (q.type === 'mc') {
addMCQuestion(q.text, q.options, q.correctAnswer);
}
});
}
function startExam() {
const studentName = document.getElementById('studentName').value.trim();
const tfCount = parseInt(document.getElementById('tfCountInput').value) || 0;
const mcCount = parseInt(document.getElementById('mcCountInput').value) || 0;
const rangeStart = parseInt(document.getElementById('rangeStart').value) || 1;
const rangeEnd = parseInt(document.getElementById('rangeEnd').value) || 1000;
if (!studentName) {
alert('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨/Ø© Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!');
return;
}
if (tfCount === 0 && mcCount === 0) {
alert('âŒ ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† ÙƒÙ„ Ù†ÙˆØ¹ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!');
return;
}
examData.studentName = studentName;
// ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ù…Ø¯Ù‰
let availableTF = examData.questions.filter(q => q.type === 'tf' && q.id && parseInt(q.id.split('-')[1]) >= rangeStart && parseInt(q.id.split('-')[1]) <= rangeEnd);
let availableMC = examData.questions.filter(q => q.type === 'mc' && q.id && parseInt(q.id.split('-')[1]) >= rangeStart && parseInt(q.id.split('-')[1]) <= rangeEnd);
if (availableTF.length < tfCount || availableMC.length < mcCount) {
alert('âš ï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ø§Ù„Ù…Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø¯Ø¯ (Ø¨ÙŠÙ† ' + rangeStart + ' Ùˆ ' + rangeEnd + ') Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨. ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©.');
return;
}
// Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù„Ø£Ø³Ø¦Ù„Ø©
const selectedTF = shuffleArray(availableTF).slice(0, tfCount);
const selectedMC = shuffleArray(availableMC).slice(0, mcCount);
let finalQuestions = shuffleArray([...selectedTF, ...selectedMC]);
if (finalQuestions.length === 0) {
alert('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ø£Ø³Ø¦Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø¯Ø¯ ÙˆØ§Ù„Ù…Ø¯Ù‰.');
return;
}
// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
finalQuestions = finalQuestions.map(q => ({ ...q, answer: null }));
examData.currentExamQuestions = finalQuestions;
document.getElementById('examTitle').textContent = `Ø§Ø®ØªØ¨Ø§Ø±: ${examData.name} Ù„Ù„Ø·Ø§Ù„Ø¨/Ø©: ${studentName}`;
// Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰
document.getElementById('createExamSection').classList.add('hidden');
document.getElementById('a4TestBuilder').classList.add('hidden');
document.getElementById('schoolAnalysisContainer').classList.add('hidden');
document.getElementById('remedialPlanContainer').classList.add('hidden');
document.getElementById('originalContent').classList.remove('hidden');
document.getElementById('examSection').classList.remove('hidden');
// Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
renderExamQuestions(examData.currentExamQuestions);
// Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
startTimer(examData.duration);
// Ø¥Ø®ÙØ§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
document.getElementById('shareControls').style.display = 'none';
}
function renderExamQuestions(questions) {
const examQuestionsDiv = document.getElementById('examQuestions');
examQuestionsDiv.innerHTML = '';
questions.forEach((q, index) => {
const questionNum = index + 1;
let questionHTML = '';
if (q.type === 'tf') {
questionHTML = `
<div class="question-container" id="exam-q-${q.id}">
<div class="question-header">
<span class="question-number">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø±Ù‚Ù… ${questionNum} (ØµÙˆØ§Ø¨/Ø®Ø·Ø£):</span>
</div>
<p>${q.text}</p>
<div style="display: flex; gap: 20px;">
<label style="font-weight: normal;"><input type="radio" name="student-answer-${q.id}" value="ØµÙˆØ§Ø¨"> ØµÙˆØ§Ø¨</label>
<label style="font-weight: normal;"><input type="radio" name="student-answer-${q.id}" value="Ø®Ø·Ø£"> Ø®Ø·Ø£</label>
</div>
</div>
`;
} else if (q.type === 'mc') {
const optionsHTML = q.options.map((opt, optIndex) => `
<label style="font-weight: normal;">
<input type="radio" name="student-answer-${q.id}" value="${opt}">
${MC_LETTERS[optIndex]}. ${opt}
</label>
`).join('');
questionHTML = `
<div class="question-container" id="exam-q-${q.id}">
<div class="question-header">
<span class="question-number">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø±Ù‚Ù… ${questionNum} (Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯):</span>
</div>
<p>${q.text}</p>
<div class="options-list">
${optionsHTML}
</div>
</div>
`;
}
examQuestionsDiv.insertAdjacentHTML('beforeend', questionHTML);
});
}
function startTimer(duration) {
let timeRemaining = duration * 60; // Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
const timerEl = document.getElementById('timer');
timerEl.classList.remove('warning');
clearInterval(examTimer);
const formatTime = (seconds) => {
const min = String(Math.floor(seconds / 60)).padStart(2, '0');
const sec = String(seconds % 60).padStart(2, '0');
return `${min}:${sec}`;
};
examTimer = setInterval(() => {
timeRemaining--;
timerEl.textContent = `â±ï¸ ${formatTime(timeRemaining)}`;
if (timeRemaining <= 60) {
timerEl.classList.add('warning');
}
if (timeRemaining <= 0) {
clearInterval(examTimer);
submitExam(true); // ØªØ³Ù„ÙŠÙ… Ø¥Ø¬Ø¨Ø§Ø±ÙŠ
}
}, 1000);
}
function submitExam(isAutoSubmit) {
clearInterval(examTimer);
if (!isAutoSubmit && !confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŸ Ù„Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ.')) {
startTimer(Math.floor(parseInt(document.getElementById('timer').textContent.split(' ')[1].split(':')[0]) * 60 + parseInt(document.getElementById('timer').textContent.split(':')[1])));
return;
}
const results = {
studentName: examData.studentName,
examName: examData.name,
totalQuestions: examData.currentExamQuestions.length,
correctCount: 0,
incorrectCount: 0,
unansweredCount: 0,
score: 0,
questions: [],
unansweredQuestions: []
};
// Ø¬Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬
examData.currentExamQuestions.forEach((q, index) => {
const questionNum = index + 1;
const selectedRadio = document.querySelector(`input[name="student-answer-${q.id}"]:checked`);
const studentAnswer = selectedRadio ? selectedRadio.value.trim() : null;
const isCorrect = studentAnswer === q.correctAnswer;
if (studentAnswer === null) {
results.unansweredCount++;
results.unansweredQuestions.push(questionNum);
} else if (isCorrect) {
results.correctCount++;
results.score++;
} else {
results.incorrectCount++;
}
results.questions.push({
...q,
questionNum: questionNum,
studentAnswer: studentAnswer,
isCorrect: isCorrect
});
});
results.percentage = (results.score / results.totalQuestions) * 100;
window.currentResults = results;
displayResults(results, isAutoSubmit);
// Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
document.getElementById('examSection').classList.add('hidden');
document.getElementById('resultsSection').classList.remove('hidden');
}
function displayResults(results, isAutoSubmit) {
const scoreDisplayEl = document.getElementById('scoreDisplay');
const detailedResultsEl = document.getElementById('detailedResults');
const feedback = getFeedbackMessage(results.percentage);
// 1. Ø¹Ø±Ø¶ Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªÙŠØ¬Ø©
scoreDisplayEl.innerHTML = `
<h2>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (${results.examName})</h2>
<p>${results.studentName}</p>
<div class="score-summary-container">
<div class="score-card feedback-card">
<div class="icon">${feedback.icon}</div>
<div class="message">${feedback.message}</div>
<p>${isAutoSubmit ? 'âš ï¸ ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø³Ø¨Ø¨ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª.' : ''}</p>
</div>
<div class="score-card score-card-primary">
<div class="score-value">${results.score} / ${results.totalQuestions}</div>
<div class="score-label">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (Ø§Ù„Ø¯Ø±Ø¬Ø§Øª)</div>
</div>
<div class="score-card" style="border-right: 8px solid #007bff;">
<div class="score-value">${results.percentage.toFixed(1)}%</div>
<div class="score-label">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</div>
</div>
</div>
<div class="performance-summary-table">
<h3>Ù…Ù„Ø®Øµ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
<table class="performance-table">
<thead>
<tr>
<th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</th>
<th class="col-correct">ØµØ­ÙŠØ­</th>
<th class="col-incorrect">Ø®Ø·Ø£</th>
<th class="col-unanswered">Ù„Ù… ØªØªÙ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</th>
</tr>
</thead>
<tbody>
<tr>
<td class="col-total">${results.totalQuestions}</td>
<td class="col-correct">${results.correctCount}</td>
<td class="col-incorrect">${results.incorrectCount}</td>
<td class="col-unanswered">${results.unansweredCount}</td>
</tr>
</tbody>
</table>
</div>
`;
// 2. Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
detailedResultsEl.innerHTML = `<h3>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© ÙˆÙ†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù:</h3>`;
results.questions.forEach(q => {
const statusClass = q.studentAnswer === null ? 'unanswered' : (q.isCorrect ? 'correct' : 'incorrect');
const statusText = q.studentAnswer === null ? 'Ù„Ù… ØªØªÙ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©' : (q.isCorrect ? 'ØµØ­ÙŠØ­Ø©' : 'Ø®Ø§Ø·Ø¦Ø©');
const statusMsgClass = statusClass.replace('unanswered', 'unanswered'); // Ù„ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù†
const detailedItem = `
<div class="result-item ${statusClass}">
<p><strong>Ø§Ù„Ø³Ø¤Ø§Ù„ Ø±Ù‚Ù… ${q.questionNum}:</strong> ${q.text}</p>
<div class="status-message ${statusMsgClass}">
Ø§Ù„Ø­Ø§Ù„Ø©: ${statusText}
</div>
<p>
<strong>Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> ${q.studentAnswer !== null ? q.studentAnswer : '-'}
<br>
<strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</strong> ${q.correctAnswer}
</p>
${statusClass === 'incorrect' ? '<p style="font-size: 0.9em; color: #dc3545; font-weight: bold;">ğŸš¨ Ù†Ù‚Ø·Ø© Ø¶Ø¹Ù Ù…Ø­ØªÙ…Ù„Ø©: Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙÙ‡ÙˆÙ….</p>' : ''}
</div>
`;
detailedResultsEl.insertAdjacentHTML('beforeend', detailedItem);
});
}
function saveResults() {
if (!window.currentResults) {
alert('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ø­ÙØ¸Ù‡Ø§!');
return;
}
const dataStr = JSON.stringify(window.currentResults, null, 2);
const blob = new Blob([dataStr], { type: 'application/json' });
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = `${window.currentResults.examName}_Result_${window.currentResults.studentName}_${new Date().toISOString().slice(0, 10)}.json`;
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ø§Ù„ØªÙØµÙŠÙ„!');
}
function printResults() {
if (!window.currentResults) {
alert('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©!');
return;
}
// Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
document.querySelectorAll('#resultsSection button').forEach(btn => btn.style.display = 'none');
window.print();
// Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (Ø£Ùˆ Ø¥Ù„ØºØ§Ø¦Ù‡Ø§)
document.querySelectorAll('#resultsSection button').forEach(btn => btn.style.display = 'inline-block');
}
function resetExam() {
document.getElementById('examName').value = 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ';
document.getElementById('examDuration').value = '30';
document.getElementById('tfCountInput').value = '0';
document.getElementById('mcCountInput').value = '0';
document.getElementById('studentName').value = '';
document.getElementById('tfQuestions').innerHTML = '';
document.getElementById('mcQuestions').innerHTML = '';
tfQuestionCount = 0;
mcQuestionCount = 0;
examData = { name: '', duration: 0, questions: [], submissionDeadline: null, studentName: '' };
window.currentResults = null;
document.getElementById('resultsSection').classList.add('hidden');
document.getElementById('examSection').classList.add('hidden');
document.getElementById('createExamSection').classList.remove('hidden');
updateDeadlineInfo();
}
// ----------------------------------------------------
// Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© (Dropdown)
// ----------------------------------------------------
function showA4TestBuilder() {
// Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰
document.getElementById('originalContent').classList.add('hidden');
document.getElementById('schoolAnalysisContainer').classList.add('hidden');
document.getElementById('remedialPlanContainer').classList.add('hidden');
// Ø¹Ø±Ø¶ Ù‚Ø³Ù… A4 Builder
document.getElementById('a4TestBuilder').classList.remove('hidden');
}
function hideA4TestBuilder() {
document.getElementById('a4TestBuilder').classList.add('hidden');
document.getElementById('originalContent').classList.remove('hidden');
}
function showSchoolAnalysis() {
document.getElementById('originalContent').classList.add('hidden');
document.getElementById('a4TestBuilder').classList.add('hidden');
document.getElementById('remedialPlanContainer').classList.add('hidden');
document.getElementById('schoolAnalysisContainer').classList.remove('hidden');
}
function hideSchoolAnalysis() {
document.getElementById('schoolAnalysisContainer').classList.add('hidden');
document.getElementById('originalContent').classList.remove('hidden');
}
function showRemedialPlan() {
document.getElementById('originalContent').classList.add('hidden');
document.getElementById('a4TestBuilder').classList.add('hidden');
document.getElementById('schoolAnalysisContainer').classList.add('hidden');
document.getElementById('remedialPlanContainer').classList.remove('hidden');
// ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
document.getElementById('remedial_date').value = new Date().toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' });
populateRemedialLists(); // Ù…Ù„Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ø§Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
}
function hideRemedialPlan() {
document.getElementById('remedialPlanContainer').classList.add('hidden');
document.getElementById('originalContent').classList.remove('hidden');
}
// ----------------------------------------------------
// Ø¯ÙˆØ§Ù„ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© (Remedial Plan)
// ----------------------------------------------------
function handleRemedialLogoUpload() {
const file = document.getElementById('remedial_logo_upload').files[0];
if (!file) return;
const reader = new FileReader();
reader.onload = function (e) {
remedialLogoDataURL = e.target.result;
// ÙŠÙ…ÙƒÙ† ÙˆØ¶Ø¹ Ù…Ø¤Ø´Ø± Ø¨ØµØ±ÙŠ Ù‡Ù†Ø§
document.querySelector('#remedialPlanForm button[onclick="removeRemedialLogo()"]').style.display = 'inline-block';
document.querySelector('#remedialPlanForm input[type="file"]').style.backgroundColor = '#d4edda';
};
reader.readAsDataURL(file);
}
function removeRemedialLogo() {
remedialLogoDataURL = null;
document.getElementById('remedial_logo_upload').value = '';
document.querySelector('#remedialPlanForm button[onclick="removeRemedialLogo()"]').style.display = 'none';
document.querySelector('#remedialPlanForm input[type="file"]').style.backgroundColor = 'white';
}
function getRemedialPlanData() {
const studentName = document.getElementById('remedial_studentName').value.trim();
const teacherName = document.getElementById('remedial_teacherName').value.trim();
const subject = document.getElementById('remedial_subject').value.trim();
const className = document.getElementById('remedial_class').value.trim();
const date = document.getElementById('remedial_date').value;
const directorName = document.getElementById('remedial_directorName').value.trim();
const notes = document.getElementById('remedial_notes').value.trim();
const improvementResult = document.getElementById('remedial_improvementResult').value;
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©
if (!studentName || !teacherName || !subject || !className || !improvementResult) {
alert('âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨/Ø©ØŒ Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ø³Ù†ØŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…/Ø©ØŒ Ø§Ù„Ù…Ø§Ø¯Ø©ØŒ ÙˆØ§Ù„ØµÙ) Ù‚Ø¨Ù„ Ø§Ù„ØªÙ†Ø²ÙŠÙ„/Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.');
return null;
}
const getCheckedItems = (listId) => {
return Array.from(document.getElementById(listId).querySelectorAll('input[type="checkbox"]:checked'))
.map(input => input.value);
};
return {
studentName,
teacherName,
subject,
className,
date,
directorName,
notes,
improvementResult,
weaknesses: getCheckedItems('weaknessList'),
methods: getCheckedItems('methodsList'),
actions: getCheckedItems('actionsList'),
logoDataURL: remedialLogoDataURL
};
}
function generateRemedialPlanHTML(data) {
if (!data) return '';
const logoHTML = data.logoDataURL ? `<img src="${data.logoDataURL}" alt="Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ²Ø§Ø±Ø©">` : `Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ²Ø§Ø±Ø©`;
const weaknessList = data.weaknesses.map(item => `<li>${item}</li>`).join('');
const methodsList = data.methods.map(item => `<li>${item}</li>`).join('');
const actionsList = data.actions.map(item => `<li>${item}</li>`).join('');
const notesHTML = data.notes ? `<div class="report-section"><div class="section-header section-header-results"><i class="fas fa-file-alt"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</div><div class="section-body"><p>${data.notes}</p></div></div>` : '';
return `
<div class="remedial-report-container" id="remedialPlanReportContent">
<div class="report-header-banner">
<div class="report-logo-placeholder">${logoHTML}</div>
<div class="report-header-content">
</div>
</div>
<div class="report-title-box">
ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø§Ù„ÙØ±Ø¯ÙŠØ©
</div>
<div class="report-info-section">
<p><strong>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨/Ø©:</strong> ${data.studentName}</p>
<p><strong>Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> ${data.subject} | <strong>Ø§Ù„ØµÙ:</strong> ${data.className}</p>
<p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…/Ø©:</strong> ${data.teacherName} | <strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯:</strong> ${data.date}</p>
</div>
<div class="report-section">
<div class="section-header section-header weakness"><i class="fas fa-exclamation-triangle"></i> Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ø§Ù„ØªÙŠ ØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡Ø§</div>
<div class="section-body">
${data.weaknesses.length > 0 ? `<ul>${weaknessList}</ul>` : '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù Ù…Ø­Ø¯Ø¯Ø©.</p>'}
</div>
</div>
<div class="report-section">
<div class="section-header section-header methods"><i class="fas fa-tools"></i> Ø·Ø±Ù‚ ÙˆØ£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</div>
<div class="section-body">
${data.methods.length > 0 ? `<ul>${methodsList}</ul>` : '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø±Ù‚ Ø¹Ù„Ø§Ø¬ Ù…Ù‚ØªØ±Ø­Ø©.</p>'}
</div>
</div>
<div class="report-section">
<div class="section-header section-header actions"><i class="fas fa-tasks"></i> Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø§Ù„Ù…ØªØ®Ø°Ø©/Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</div>
<div class="section-body">
${data.actions.length > 0 ? `<ul>${actionsList}</ul>` : '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¹Ù„Ø§Ø¬ÙŠØ© Ù…Ù‚ØªØ±Ø­Ø©.</p>'}
</div>
</div>
<div class="report-section">
<div class="section-header section-header results"><i class="fas fa-chart-line"></i> Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ø³Ù† Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©/Ø§Ù„Ø­Ø§Ù„ÙŠØ©</div>
<div class="section-body">
<p style="font-size: 1.1em; font-weight: bold; color: #007bff;">${data.improvementResult}</p>
</div>
</div>
${notesHTML}
<div class="report-signature-section">
<div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù… / Ø§Ù„Ù…Ø¹Ù„Ù…Ø©:</div>
<div>ØªÙˆÙ‚ÙŠØ¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© / Ø§Ù„Ù…Ø¯ÙŠØ±Ø©: ${data.directorName}</div>
</div>
</div>
`;
}
function printRemedialPlan() {
const data = getRemedialPlanData();
if (!data) return;
const printContainer = document.querySelector('.pdf-content-remedial-print');
printContainer.innerHTML = generateRemedialPlanHTML(data);
printContainer.style.display = 'block'; // Ensure it's visible for printing
// Hide main app content
document.getElementById('remedialPlanContainer').classList.add('hidden');
// Use the browser's native print dialog
setTimeout(() => {
window.print();
// Restore visibility
document.getElementById('remedialPlanContainer').classList.remove('hidden');
printContainer.innerHTML = '';
printContainer.style.display = 'none';
}, 100);
}
function generateRemedialPlanPDF() {
const data = getRemedialPlanData();
if (!data) return;
const element = document.createElement('div');
element.innerHTML = generateRemedialPlanHTML(data);
// Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù€ PDF content container ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆÙ„ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø¥Ù†Ø´Ø§Ø¡ PDF
const filename = `Ø§Ù„Ø®Ø·Ø©_Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ©_${data.studentName.split(' ')[0]}_${data.subject}.pdf`;
html2pdf().from(element).set({
margin: [10, 10, 10, 10], // top, left, bottom, right
filename: filename,
image: { type: 'jpeg', quality: 0.98 },
html2canvas: { scale: 2, logging: true, dpi: 192, letterRendering: true },
jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
pagebreak: { before: '.pdf-page-break' }
}).save();
}
// ----------------------------------------------------
// Ø¯ÙˆØ§Ù„ ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (School Analysis)
// ----------------------------------------------------
function handleSchoolResultsUpload() {
const files = document.getElementById('schoolResultsUpload').files;
if (files.length === 0) return;
window.schoolResults = []; // ØªÙØ±ÙŠØº Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
let filesProcessed = 0;
const totalFiles = files.length;
const reader = new FileReader();
const processNextFile = () => {
if (filesProcessed < totalFiles) {
const file = files[filesProcessed];
reader.onload = function (e) {
try {
const result = JSON.parse(e.target.result);
if (result.studentName && result.examName && result.totalQuestions) {
window.schoolResults.push(result);
} else {
console.warn(`Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­: ${file.name}`);
}
} catch (error) {
console.error(`Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù JSON: ${file.name}`, error);
}
filesProcessed++;
processNextFile();
};
reader.readAsText(file);
} else {
alert(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${window.schoolResults.length} Ù†ØªÙŠØ¬Ø© ØµØ§Ù„Ø­Ø© Ù…Ù† ${totalFiles} Ù…Ù„Ù.`);
document.getElementById('schoolAnalysisControls').style.border = '2px solid #28a745'; // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù†Ø¬Ø§Ø­
}
};
processNextFile();
}
function analyzeSchoolPerformance() {
if (window.schoolResults.length === 0) {
alert('âŒ ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹!');
return;
}
const analysisOutput = document.getElementById('schoolAnalysisOutput');
analysisOutput.innerHTML = '';
analysisOutput.classList.remove('hidden');
const totalStudents = window.schoolResults.length;
const totalQuestions = window.schoolResults.length > 0 ? window.schoolResults[0].totalQuestions : 0;
if (totalQuestions === 0) {
analysisOutput.innerHTML = '<p style="text-align: center; color: #dc3545;">âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„. Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØºÙŠØ± Ù…Ø­Ø¯Ø¯ Ø£Ùˆ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª.</p>';
return;
}
let totalCorrect = 0;
let totalIncorrect = 0;
let totalUnanswered = 0;
let questionStats = new Array(totalQuestions).fill(0).map(() => ({ correct: 0, incorrect: 0, unanswered: 0 }));
// ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„Ø®Ø§ØµØ© Ø¨ÙƒÙ„ Ø³Ø¤Ø§Ù„
window.schoolResults.forEach(result => {
totalCorrect += result.correctCount;
totalIncorrect += result.incorrectCount;
totalUnanswered += result.unansweredCount;
result.questions.forEach((q, index) => {
if (index < totalQuestions) {
if (q.isCorrect) {
questionStats[index].correct++;
} else if (q.studentAnswer === null) {
questionStats[index].unanswered++;
} else {
questionStats[index].incorrect++;
}
}
});
});
const overallCorrectPercentage = (totalCorrect / (totalStudents * totalQuestions)) * 100;
const overallIncorrectPercentage = (totalIncorrect / (totalStudents * totalQuestions)) * 100;
const overallUnansweredPercentage = (totalUnanswered / (totalStudents * totalQuestions)) * 100;
// Ø¨Ù†Ø§Ø¡ Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„
analysisOutput.insertAdjacentHTML('beforeend', `
<div id="schoolAnalysisSection">
<h3>ğŸ“Š ØªÙ‚Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©/Ø§Ù„ÙØµÙˆÙ„ ğŸ“Š</h3>
<h4>Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù…:</h4>
<div id="schoolSummary">
<div class="analysis-card" style="border-right: 5px solid #007bff;">
<div class="analysis-card-value">${totalStudents}</div>
<div class="score-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ (Ù†ØªØ§Ø¦Ø¬)</div>
</div>
<div class="analysis-card" style="border-right: 5px solid #28a745;">
<div class="analysis-card-value">${overallCorrectPercentage.toFixed(1)}%</div>
<div class="score-label">Ù…ØªÙˆØ³Ø· Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</div>
</div>
<div class="analysis-card" style="border-right: 5px solid #dc3545;">
<div class="analysis-card-value">${overallIncorrectPercentage.toFixed(1)}%</div>
<div class="score-label">Ù…ØªÙˆØ³Ø· Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©</div>
</div>
<div class="analysis-card" style="border-right: 5px solid #ffc107;">
<div class="analysis-card-value">${overallUnansweredPercentage.toFixed(1)}%</div>
<div class="score-label">Ù…ØªÙˆØ³Ø· Ù†Ø³Ø¨Ø© Ø¹Ø¯Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</div>
</div>
</div>
<h4>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù…:</h4>
<div class="school-chart-container">
<div class="chart-bar-wrap-full">
<div class="chart-bar-full" style="width: ${overallCorrectPercentage}%; background-color: #28a745;">
${overallCorrectPercentage.toFixed(1)}% ØµØ­ÙŠØ­
</div>
<div class="chart-bar-full" style="width: ${overallIncorrectPercentage}%; background-color: #dc3545;">
${overallIncorrectPercentage.toFixed(1)}% Ø®Ø·Ø£
</div>
<div class="chart-bar-full" style="width: ${overallUnansweredPercentage}%; background-color: #ffc107;">
${overallUnansweredPercentage.toFixed(1)}% Ù„Ù… ÙŠØ¬Ø¨
</div>
</div>
<div class="chart-legend">
<div class="legend-item"><span class="legend-color" style="background-color: #28a745;"></span>ØµØ­ÙŠØ­</div>
<div class="legend-item"><span class="legend-color" style="background-color: #dc3545;"></span>Ø®Ø·Ø£</div>
<div class="legend-item"><span class="legend-color" style="background-color: #ffc107;"></span>Ù„Ù… ÙŠØ¬Ø¨</div>
</div>
</div>
<h4>ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠ (Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©):</h4>
<div class="performance-summary-table" style="page-break-after: always;">
<table class="performance-table">
<thead>
<tr>
<th>Ø§Ù„Ø³Ø¤Ø§Ù„ Ø±Ù‚Ù…</th>
<th class="col-total">Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„</th>
<th>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨</th>
<th class="col-correct">ØµØ­ÙŠØ­ (Ù†Ø³Ø¨Ø©)</th>
<th class="col-incorrect">Ø®Ø·Ø£ (Ù†Ø³Ø¨Ø©)</th>
<th class="col-unanswered">Ù„Ù… ÙŠØ¬Ø¨ (Ù†Ø³Ø¨Ø©)</th>
</tr>
</thead>
<tbody>
${questionStats.map((stat, index) => {
const q = window.schoolResults[0].questions.find(item => item.questionNum === index + 1);
const correctPct = (stat.correct / totalStudents) * 100;
const incorrectPct = (stat.incorrect / totalStudents) * 100;
const unansweredPct = (stat.unanswered / totalStudents) * 100;
const isWeakness = incorrectPct >= 50 || unansweredPct >= 30; // Ø§ÙØªØ±Ø§Ø¶ Ù†Ù‚Ø·Ø© Ø¶Ø¹Ù
return `
<tr style="${isWeakness ? 'background-color: #f8d7da;' : ''}">
<td>${index + 1}</td>
<td style="max-width: 200px; white-space: normal; text-align: right; font-weight: normal;">${q ? q.text.substring(0, 100) + (q.text.length > 100 ? '...' : '') : 'N/A'}</td>
<td>${totalStudents}</td>
<td class="col-correct">${stat.correct} (${correctPct.toFixed(1)}%)</td>
<td class="col-incorrect">${stat.incorrect} (${incorrectPct.toFixed(1)}%)</td>
<td class="col-unanswered">${stat.unanswered} (${unansweredPct.toFixed(1)}%)</td>
</tr>
`;
}).join('')}
</tbody>
</table>
</div>
</div>
`);
}
function downloadSchoolAnalysisPDF() {
const element = document.getElementById('schoolAnalysisSection');
if (!element || element.innerHTML.trim() === '') {
alert('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.');
return;
}
const filename = `ØªØ­Ù„ÙŠÙ„_Ø£Ø¯Ø§Ø¡_Ø§Ù„Ù…Ø¯Ø±Ø³Ø©_${new Date().toISOString().slice(0, 10)}.pdf`;
html2pdf().from(element).set({
margin: [15, 10, 15, 10], // top, left, bottom, right
filename: filename,
image: { type: 'jpeg', quality: 0.98 },
html2canvas: { scale: 2, logging: true, dpi: 192, letterRendering: true },
jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
pagebreak: { mode: 'css' } // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø¨Ù€ CSS
}).save();
}
function printSchoolAnalysis() {
const element = document.getElementById('schoolAnalysisSection');
if (!element || element.innerHTML.trim() === '') {
alert('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.');
return;
}
// Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
document.getElementById('originalContent').classList.add('hidden');
document.getElementById('a4TestBuilder').classList.add('hidden');
document.getElementById('remedialPlanContainer').classList.add('hidden');
document.getElementById('schoolAnalysisContainer').classList.remove('hidden');
// Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
window.print();
// Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
document.getElementById('schoolAnalysisContainer').classList.add('hidden');
document.getElementById('originalContent').classList.remove('hidden');
}
// ----------------------------------------------------
// Ø¯ÙˆØ§Ù„ Ø¥Ø¹Ø¯Ø§Ø¯ Ù†Ù…ÙˆØ°Ø¬ A4 (Test Builder)
// ----------------------------------------------------
let a4QuestionCounter = 0;
function addA4QuestionType(type) {
const list = document.getElementById('a4QuestionsList');
const qId = a4QuestionCounter++;
let title = '';
let contentHTML = '';
if (type === 'mcq') {
title = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${qId + 1}: Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ Ùˆ ØµÙˆØ§Ø¨/Ø®Ø·Ø£`;
contentHTML = `
<p>
**Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ù…ØµÙ…Ù…:** ÙŠÙ…ÙƒÙ†Ùƒ Ù‡Ù†Ø§ ÙˆØ¶Ø¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ø¥Ø¹Ø¯Ø§Ø¯Ù‡Ø§ Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ù‚Ø³Ù… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©ØŒ Ø£Ùˆ ÙƒØªØ§Ø¨ØªÙ‡Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©.
</p>
<textarea rows="5" placeholder="Ø§ÙƒØªØ¨ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ ÙˆØ§Ù„ØµÙˆØ§Ø¨ ÙˆØ§Ù„Ø®Ø·Ø£ Ø¨Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù‡Ù†Ø§. ÙŠÙ…ÙƒÙ†Ùƒ Ù„ØµÙ‚Ù‡Ø§ Ù…Ù† Ù‚Ø³Ù… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¨Ø¹Ø¯ Ø­ÙØ¸Ù‡Ø§."></textarea>
`;
} else if (type === 'essay') {
title = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${qId + 1}: Ø£Ø³Ø¦Ù„Ø© Ù…Ù‚Ø§Ù„ÙŠØ© (Ø¹Ù„Ù„/Ø¹Ø±Ù/Ø§Ø´Ø±Ø­...)`;
contentHTML = `
<textarea rows="8" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ù‚Ø§Ù„ÙŠ ÙƒØ§Ù…Ù„Ø§Ù‹ Ù‡Ù†Ø§ØŒ ÙˆØ§ØªØ±Ùƒ Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©." style="width: 100%;"></textarea>
<p style="font-size: 0.8em; color: #555;">(Ù‡Ø°Ø§ Ø³ÙŠØ¸Ù‡Ø± ÙƒÙ…Ù†Ø·Ù‚Ø© Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©)</p>
`;
} else if (type === 'matching') {
title = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${qId + 1}: Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ù† / Ø§Ù„ØªÙˆØµÙŠÙ„`;
contentHTML = `
<textarea rows="8" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„ (Ø£) ÙˆØ§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø¨) Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ù…Ø¹ Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨." style="width: 100%;"></textarea>
<p style="font-size: 0.8em; color: #555;">(Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¨Ø¬Ø§Ù†Ø¨ Ø¨Ø¹Ø¶Ù‡Ø§)</p>
`;
}
const qHTML = `
<div class="a4-question-container" id="a4-q-${qId}" data-type="${type}">
<div class="question-header">
<span class="question-number">${title}</span>
<button class="delete-btn" onclick="deleteQuestion('a4-q-${qId}')">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù…</button>
</div>
${contentHTML}
</div>
`;
list.insertAdjacentHTML('beforeend', qHTML);
}
function generateA4TestHTML() {
const countryName = document.getElementById('countryName').value.trim();
const schoolName = document.getElementById('schoolName').value.trim();
const examSubject = document.getElementById('examSubject').value.trim();
const examDurationA4 = document.getElementById('examDurationA4').value.trim();
const totalGrade = document.getElementById('totalGrade').value.trim();
const examTitleA4 = document.getElementById('examTitleA4').value.trim();
let logoSrc = '';
// Ø§Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø´Ø¹Ø§Ø± Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§
if (remedialLogoDataURL) {
logoSrc = `<img src="${remedialLogoDataURL}" style="max-width: 100%; max-height: 100px; object-fit: contain;">`;
}
const klishehHTML = `
<div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
<div style="width: 30%; text-align: right; line-height: 1.5; font-size: 10pt;">
<strong>${countryName}</strong><br>
<strong>${schoolName}</strong>
</div>
<div style="width: 40%; text-align: center;">
${logoSrc || '<span>Ø´Ø¹Ø§Ø±</span>'}
</div>
<div style="width: 30%; text-align: left; line-height: 1.5; font-size: 10pt;">
<strong>Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> ${examSubject}<br>
<strong>Ø§Ù„Ø²Ù…Ù†:</strong> ${examDurationA4}<br>
<strong>Ø§Ù„Ø¯Ø±Ø¬Ø©:</strong> ${totalGrade}
</div>
</div>
<h2 style="text-align: center; color: #333; border-bottom: 2px solid #333; padding-bottom: 10px; margin-top: 0; font-size: 1.5em;">${examTitleA4}</h2>
<div style="display: flex; justify-content: space-around; text-align: center; border: 1px solid #333; padding: 10px; margin-bottom: 20px;">
<div style="width: 30%; border-left: 1px solid #333;"><strong>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> </div>
<div style="width: 30%; border-left: 1px solid #333;"><strong>Ø§Ù„ØµÙ:</strong> </div>
<div style="width: 30%;"><strong>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ:</strong> </div>
</div>
`;
let questionsHTML = '';
document.querySelectorAll('#a4QuestionsList .a4-question-container').forEach((qDiv, index) => {
const qType = qDiv.dataset.type;
const qText = qDiv.querySelector('textarea').value;
const qTitle = qDiv.querySelector('.question-number').textContent.replace(/Ø³Ø¤Ø§Ù„ \d+:/, `Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}:`);
questionsHTML += `
<div class="a4-question-container" style="page-break-inside: avoid;">
<h4 style="color: #007bff; border-bottom: 1px solid #ddd; padding-bottom: 5px; margin-top: 0;">${qTitle}</h4>
<div style="padding: 10px; line-height: 1.5; font-size: 11pt;">
<pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">${qText}</pre>
${qType === 'essay' ? '<div style="height: 100px; border: 1px dashed #ccc; margin-top: 10px;"></div>' : ''}
</div>
</div>
`;
});
return `
<div style="max-width: 210mm; margin: 0 auto; padding: 15mm; direction: rtl; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 12pt;">
${klishehHTML}
${questionsHTML}
<div class="pdf-page-break"></div>
<div style="text-align: center; margin-top: 50px;">
<p style="font-weight: bold;">ØªÙ…Ù†ÙŠØ§ØªÙ†Ø§ Ù„ÙƒÙ… Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ù†Ø¬Ø§Ø­</p>
<p style="border-top: 1px dashed #777; width: 30%; margin: 30px auto 0 auto;">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù… / Ø§Ù„Ù…Ø¹Ù„Ù…Ø©</p>
</div>
</div>
`;
}
function saveA4Draft() {
// ... (ØªÙ†ÙÙŠØ° Ø­ÙØ¸ Ø§Ù„Ù…Ø³ÙˆØ¯Ø©) ...
alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø¨Ù†Ø¬Ø§Ø­ (ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø­ÙØ¸ Ù„Ù… ØªÙ†ÙØ° Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯).');
}
function printA4Test() {
const printContent = generateA4TestHTML();
const printWindow = window.open('', '_blank');
printWindow.document.write('<html><head><title>Ù†Ù…ÙˆØ°Ø¬ Ø§Ø®ØªØ¨Ø§Ø± A4</title>');
printWindow.document.write('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">');
printWindow.document.write('<style>');
printWindow.document.write(`
@page { size: A4; margin: 15mm; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl; font-size: 12pt; margin: 0; padding: 0; }
.a4-question-container { border: 1px solid #333; padding: 10px; margin-bottom: 10px; page-break-inside: avoid; }
pre { white-space: pre-wrap; margin: 0; font-family: inherit; }
`);
printWindow.document.write('</style></head><body>');
printWindow.document.write(printContent);
printWindow.document.write('</body></html>');
printWindow.document.close();
printWindow.print();
}
function downloadA4Test(format) {
const htmlContent = generateA4TestHTML();
if (format === 'pdf') {
const element = document.createElement('div');
element.innerHTML = htmlContent;
const filename = `Ù†Ù…ÙˆØ°Ø¬_Ø§Ø®ØªØ¨Ø§Ø±_A4_${document.getElementById('examSubject').value}.pdf`;
html2pdf().from(element).set({
margin: [15, 15, 15, 15], // top, left, bottom, right
filename: filename,
image: { type: 'jpeg', quality: 0.98 },
html2canvas: { scale: 2, logging: true, dpi: 192, letterRendering: true },
jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
pagebreak: { mode: 'css' }
}).save();
} else if (format === 'docx') {
// ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØªØ¨Ø© Ù„ØªØ­ÙˆÙŠÙ„ HTML Ø¥Ù„Ù‰ DOCX Ù‡Ù†Ø§ (Ù…Ø«Ù„ docxtemplater Ø£Ùˆ mammoth.js Ù„Ù„ØªØµØ¯ÙŠØ±)
alert('âš ï¸ Ø§Ù„ØªÙ†Ø²ÙŠÙ„ ÙƒÙ€ DOCX ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… Ø­Ø§Ù„ÙŠÙ‹Ø§ ÙˆÙŠØªØ·Ù„Ø¨ Ù…ÙƒØªØ¨Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… PDF Ø£Ùˆ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.');
}
}
// Ø¯ÙˆØ§Ù„ ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø¥ÙƒÙ…Ø§Ù„
function copyExamLink() {
alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·! (ÙˆØ¸ÙŠÙØ© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹).');
}
function toggleQRCode() {
const qrContainer = document.getElementById('qrCodeContainer');
const linkInput = document.getElementById('examLinkInput');
if (qrContainer.style.display === 'none') {
qrContainer.style.display = 'block';
// Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø² QR (ÙŠØ¬Ø¨ ØªÙˆÙ„ÙŠØ¯ Ø±Ø§Ø¨Ø· ØµØ§Ù„Ø­ Ø£ÙˆÙ„Ø§Ù‹)
const qrCodeEl = document.getElementById('qrcode');
qrCodeEl.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù‚Ø¯ÙŠÙ…
if (linkInput.value) {
new QRCode(qrCodeEl, {
text: linkInput.value,
width: 128,
height: 128,
colorDark: "#000000",
colorLight: "#ffffff",
correctLevel: QRCode.CorrectLevel.H
});
} else {
qrCodeEl.innerHTML = '<p style="color: red;">âš ï¸ Ù„Ù… ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø±Ø§Ø¨Ø· Ø¨Ø¹Ø¯.</p>';
}
} else {
qrContainer.style.display = 'none';
}
}
</script>
</body>
</html>